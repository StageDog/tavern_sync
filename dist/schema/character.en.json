{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "properties": {
    "avatar": {
      "type": "string"
    },
    "version": {
      "type": "string"
    },
    "creator": {
      "type": "string"
    },
    "creator_notes": {
      "type": "string"
    },
    "first_messages": {
      "default": [
        {}
      ],
      "type": "array",
      "items": {
        "default": {
          "content": ""
        },
        "type": "object",
        "properties": {
          "content": {
            "$ref": "#/$defs/__schema0"
          },
          "file": {
            "$ref": "#/$defs/__schema2"
          }
        }
      }
    },
    "description": {
      "default": "",
      "type": "string"
    },
    "anchors": {
      "description": "ç”¨äºå­˜æ”¾ YAML é”šç‚¹, ä¸ä¼šè¢«å®é™…ä½¿ç”¨",
      "$ref": "#/$defs/__schema4"
    },
    "worldbook": {
      "type": "string"
    },
    "entries": {
      "type": "array",
      "items": {
        "anyOf": [
          {
            "$ref": "#/$defs/__schema5"
          },
          {
            "type": "object",
            "properties": {
              "folder": {
                "type": "string"
              },
              "entries": {
                "type": "array",
                "items": {
                  "$ref": "#/$defs/__schema5"
                }
              }
            },
            "required": [
              "folder",
              "entries"
            ]
          }
        ]
      }
    },
    "extensions": {
      "description": "æ‰©å±•å­—æ®µ: ç”¨äºä¸ºé¢„è®¾ç»‘å®šé¢å¤–æ•°æ®",
      "$ref": "#/$defs/__schema36"
    }
  },
  "required": [
    "version",
    "creator",
    "creator_notes",
    "worldbook",
    "entries"
  ],
  "additionalProperties": false,
  "$defs": {
    "__schema0": {
      "description": "å†…åµŒçš„æç¤ºè¯å†…å®¹",
      "$ref": "#/$defs/__schema1"
    },
    "__schema1": {
      "type": "string"
    },
    "__schema2": {
      "description": "å¤–é“¾çš„æç¤ºè¯æ–‡ä»¶è·¯å¾„",
      "$ref": "#/$defs/__schema3"
    },
    "__schema3": {
      "type": "string"
    },
    "__schema4": {},
    "__schema5": {
      "$ref": "#/$defs/__schema6"
    },
    "__schema6": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "uid": {
          "description": "è¯¥æ¡ç›®çš„å”¯ä¸€æ ‡è¯†ç¬¦, å¦‚æœä¸è®¾ç½®æˆ–æœ‰é‡å¤åˆ™ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªæ–°çš„",
          "$ref": "#/$defs/__schema7"
        },
        "enabled": {
          "type": "boolean"
        },
        "strategy": {
          "type": "object",
          "properties": {
            "type": {
              "$ref": "#/$defs/__schema8"
            },
            "keys": {
              "$ref": "#/$defs/__schema9"
            },
            "keys_secondary": {
              "$ref": "#/$defs/__schema12"
            },
            "scan_depth": {
              "$ref": "#/$defs/__schema15"
            }
          },
          "required": [
            "type"
          ],
          "additionalProperties": false,
          "description": "æ¿€æ´»ç­–ç•¥: æ¡ç›®åº”è¯¥ä½•æ—¶æ¿€æ´»"
        },
        "position": {
          "type": "object",
          "properties": {
            "type": {
              "$ref": "#/$defs/__schema17"
            },
            "role": {
              "$ref": "#/$defs/__schema18"
            },
            "depth": {
              "$ref": "#/$defs/__schema20"
            },
            "order": {
              "$ref": "#/$defs/__schema22"
            }
          },
          "required": [
            "type",
            "order"
          ],
          "additionalProperties": false,
          "description": "æ’å…¥ä½ç½®: å¦‚æœæ¡ç›®æ¿€æ´»åº”è¯¥æ’å…¥åˆ°ä»€ä¹ˆåœ°æ–¹"
        },
        "probability": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "recursion": {
          "description": "é€’å½’è¡¨ç¤ºæŸä¸–ç•Œä¹¦æ¡ç›®è¢«æ¿€æ´»å, è¯¥æ¡ç›®çš„æç¤ºè¯åˆæ¿€æ´»äº†å…¶ä»–æ¡ç›®",
          "$ref": "#/$defs/__schema23"
        },
        "effect": {
          "type": "object",
          "properties": {
            "sticky": {
              "anyOf": [
                {
                  "$ref": "#/$defs/__schema25"
                },
                {
                  "type": "null"
                }
              ],
              "description": "é»æ€§: æ¡ç›®æ¿€æ´»å, åœ¨ä¹‹å n æ¡æ¶ˆæ¯å†…å§‹ç»ˆæ¿€æ´», æ— è§†æ¿€æ´»ç­–ç•¥ã€æ¿€æ´»æ¦‚ç‡%"
            },
            "cooldown": {
              "anyOf": [
                {
                  "$ref": "#/$defs/__schema26"
                },
                {
                  "type": "null"
                }
              ],
              "description": "å†·å´: æ¡ç›®æ¿€æ´»å, åœ¨ä¹‹å n æ¡æ¶ˆæ¯å†…ä¸èƒ½å†æ¿€æ´»"
            },
            "delay": {
              "anyOf": [
                {
                  "$ref": "#/$defs/__schema27"
                },
                {
                  "type": "null"
                }
              ],
              "description": "å»¶è¿Ÿ: èŠå¤©ä¸­è‡³å°‘æœ‰ n æ¥¼æ¶ˆæ¯æ—¶, æ‰èƒ½æ¿€æ´»æ¡ç›®"
            }
          },
          "additionalProperties": false
        },
        "group": {
          "description": "åŒ…å«ç»„",
          "$ref": "#/$defs/__schema28"
        },
        "extra": {
          "description": "é¢å¤–å­—æ®µ: ç”¨äºä¸ºé¢„è®¾æç¤ºè¯ç»‘å®šé¢å¤–æ•°æ®",
          "$ref": "#/$defs/__schema33"
        },
        "content": {
          "description": "å†…åµŒçš„æç¤ºè¯å†…å®¹",
          "$ref": "#/$defs/__schema34"
        },
        "file": {
          "description": "å¤–é“¾çš„æç¤ºè¯æ–‡ä»¶è·¯å¾„",
          "$ref": "#/$defs/__schema35"
        }
      },
      "required": [
        "name",
        "enabled",
        "strategy",
        "position"
      ],
      "additionalProperties": false
    },
    "__schema7": {
      "type": "number"
    },
    "__schema8": {
      "type": "string",
      "enum": [
        "constant",
        "selective",
        "vectorized"
      ],
      "description": "æ¿€æ´»ç­–ç•¥ç±»å‹:\n- constant: å¸¸é‡ğŸ”µ, ä¿—ç§°è“ç¯. åªéœ€è¦æ»¡è¶³ \"å¯ç”¨\"ã€\"æ¿€æ´»æ¦‚ç‡%\" ç­‰åˆ«çš„è¦æ±‚å³å¯.\n- selective: å¯é€‰é¡¹ğŸŸ¢, ä¿—ç§°ç»¿ç¯. é™¤äº†è“ç¯æ¡ä»¶, è¿˜éœ€è¦æ»¡è¶³ `keys` æ‰«ææ¡ä»¶\n- vectorized: å‘é‡åŒ–ğŸ”—. ä¸€èˆ¬ä¸ä½¿ç”¨"
    },
    "__schema9": {
      "description": "å…³é”®å­—: ç»¿ç¯æ¡ç›®å¿…é¡»åœ¨æ¬²æ‰«ææ–‡æœ¬ä¸­æ‰«æåˆ°å…¶ä¸­ä»»æ„ä¸€ä¸ªå…³é”®å­—æ‰èƒ½æ¿€æ´»",
      "$ref": "#/$defs/__schema10"
    },
    "__schema10": {
      "minItems": 1,
      "type": "array",
      "items": {
        "$ref": "#/$defs/__schema11"
      }
    },
    "__schema11": {
      "type": "string"
    },
    "__schema12": {
      "description": "æ¬¡è¦å…³é”®å­—: å¦‚æœè®¾ç½®äº†æ¬¡è¦å…³é”®å­—, åˆ™æ¡ç›®é™¤äº†åœ¨ `keys` ä¸­åŒ¹é…åˆ°ä»»æ„ä¸€ä¸ªå…³é”®å­—å¤–, è¿˜éœ€è¦æŒ‰æ¬¡è¦å…³é”®å­—çš„ `logic` æ»¡è¶³æ¬¡è¦å…³é”®å­—çš„ `keys`",
      "$ref": "#/$defs/__schema13"
    },
    "__schema13": {
      "type": "object",
      "properties": {
        "logic": {
          "type": "string",
          "enum": [
            "and_any",
            "and_all",
            "not_all",
            "not_any"
          ],
          "description": "æ¬¡è¦å…³é”®å­—é€»è¾‘:\n- and_any: æ¬¡è¦å…³é”®å­—ä¸­ä»»æ„ä¸€ä¸ªå…³é”®å­—èƒ½åœ¨æ¬²æ‰«ææ–‡æœ¬ä¸­åŒ¹é…åˆ°\n- and_all: æ¬¡è¦å…³é”®å­—ä¸­æ‰€æœ‰å…³é”®å­—éƒ½èƒ½åœ¨æ¬²æ‰«ææ–‡æœ¬ä¸­åŒ¹é…åˆ°\n- not_all: æ¬¡è¦å…³é”®å­—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…³é”®å­—æ²¡èƒ½åœ¨æ¬²æ‰«ææ–‡æœ¬ä¸­åŒ¹é…åˆ°\n- not_any: æ¬¡è¦å…³é”®å­—ä¸­æ‰€æœ‰å…³é”®å­—éƒ½æ²¡èƒ½æ¬²æ‰«ææ–‡æœ¬ä¸­åŒ¹é…åˆ°"
        },
        "keys": {
          "minItems": 1,
          "type": "array",
          "items": {
            "$ref": "#/$defs/__schema14"
          }
        }
      },
      "required": [
        "logic",
        "keys"
      ],
      "additionalProperties": false
    },
    "__schema14": {
      "type": "string"
    },
    "__schema15": {
      "description": "æ‰«ææ·±åº¦: 1 ä¸ºä»…æ‰«ææœ€åä¸€ä¸ªæ¥¼å±‚, 2 ä¸ºæ‰«ææœ€åä¸¤ä¸ªæ¥¼å±‚, ä»¥æ­¤ç±»æ¨",
      "$ref": "#/$defs/__schema16"
    },
    "__schema16": {
      "anyOf": [
        {
          "type": "string",
          "const": "same_as_global"
        },
        {
          "type": "number",
          "minimum": 1
        }
      ]
    },
    "__schema17": {
      "type": "string",
      "enum": [
        "before_character_definition",
        "after_character_definition",
        "before_example_messages",
        "after_example_messages",
        "before_author_note",
        "after_author_note",
        "at_depth"
      ],
      "description": "æ’å…¥ä½ç½®ç±»å‹:\n- before_character_definition: è§’è‰²å®šä¹‰ä¹‹å‰\n- after_character_definition: è§’è‰²å®šä¹‰ä¹‹å\n- before_example_messages: ç¤ºä¾‹æ¶ˆæ¯ä¹‹å‰\n- after_example_messages: ç¤ºä¾‹æ¶ˆæ¯ä¹‹å\n- before_author_note: ä½œè€…æ³¨é‡Šä¹‹å‰\n- after_author_note: ä½œè€…æ³¨é‡Šä¹‹å\n- at_depth: æ’å…¥åˆ°æŒ‡å®šæ·±åº¦"
    },
    "__schema18": {
      "description": "è¯¥æ¡ç›®çš„æ¶ˆæ¯èº«ä»½, ä»…ä½ç½®ç±»å‹ä¸º `'at_depth'` æ—¶æœ‰æ•ˆ",
      "$ref": "#/$defs/__schema19"
    },
    "__schema19": {
      "type": "string",
      "enum": [
        "system",
        "assistant",
        "user"
      ]
    },
    "__schema20": {
      "description": "è¯¥æ¡ç›®è¦æ’å…¥çš„æ·±åº¦, ä»…ä½ç½®ç±»å‹ä¸º `'at_depth'` æ—¶æœ‰æ•ˆ",
      "$ref": "#/$defs/__schema21"
    },
    "__schema21": {
      "type": "number"
    },
    "__schema22": {
      "type": "number"
    },
    "__schema23": {
      "type": "object",
      "properties": {
        "prevent_incoming": {
          "type": "boolean",
          "description": "ç¦æ­¢å…¶ä»–æ¡ç›®é€’å½’æ¿€æ´»æœ¬æ¡ç›®"
        },
        "prevent_outgoing": {
          "type": "boolean",
          "description": "ç¦æ­¢æœ¬æ¡ç›®é€’å½’æ¿€æ´»å…¶ä»–æ¡ç›®"
        },
        "delay_until": {
          "anyOf": [
            {
              "$ref": "#/$defs/__schema24"
            },
            {
              "type": "null"
            }
          ],
          "description": "å»¶è¿Ÿåˆ°ç¬¬ n çº§é€’å½’æ£€æŸ¥æ—¶æ‰èƒ½æ¿€æ´»æœ¬æ¡ç›®"
        }
      },
      "additionalProperties": false
    },
    "__schema24": {
      "type": "number",
      "minimum": 1
    },
    "__schema25": {
      "type": "number",
      "minimum": 1
    },
    "__schema26": {
      "type": "number",
      "minimum": 1
    },
    "__schema27": {
      "type": "number",
      "minimum": 1
    },
    "__schema28": {
      "type": "object",
      "properties": {
        "labels": {
          "minItems": 1,
          "type": "array",
          "items": {
            "$ref": "#/$defs/__schema29"
          },
          "description": "ç»„æ ‡ç­¾"
        },
        "use_priority": {
          "default": false,
          "description": "ä½¿ç”¨ä¼˜å…ˆçº§",
          "$ref": "#/$defs/__schema30"
        },
        "weight": {
          "default": 100,
          "description": "æƒé‡",
          "$ref": "#/$defs/__schema31"
        },
        "use_scoring": {
          "description": "ä½¿ç”¨è¯„åˆ†",
          "$ref": "#/$defs/__schema32"
        }
      },
      "required": [
        "labels"
      ],
      "additionalProperties": false
    },
    "__schema29": {
      "type": "string"
    },
    "__schema30": {
      "type": "boolean"
    },
    "__schema31": {
      "type": "number"
    },
    "__schema32": {
      "default": "same_as_global",
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "string",
          "const": "same_as_global"
        }
      ]
    },
    "__schema33": {
      "type": "object",
      "propertyNames": {
        "type": "string"
      },
      "additionalProperties": {}
    },
    "__schema34": {
      "type": "string"
    },
    "__schema35": {
      "type": "string"
    },
    "__schema36": {
      "type": "object",
      "properties": {
        "regex_scripts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "default": "46679ec7-9981-4f8d-a299-2fce34b1c1fc",
                "type": "string"
              },
              "script_name": {
                "type": "string"
              },
              "enabled": {
                "type": "boolean"
              },
              "find_regex": {
                "type": "string"
              },
              "replace_string": {
                "type": "string"
              },
              "source": {
                "type": "object",
                "properties": {
                  "user_input": {
                    "type": "boolean"
                  },
                  "ai_output": {
                    "type": "boolean"
                  },
                  "slash_command": {
                    "type": "boolean"
                  },
                  "world_info": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "user_input",
                  "ai_output"
                ]
              },
              "destination": {
                "type": "object",
                "properties": {
                  "display": {
                    "type": "boolean"
                  },
                  "prompt": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "display",
                  "prompt"
                ]
              },
              "run_on_edit": {
                "type": "boolean"
              },
              "min_depth": {
                "anyOf": [
                  {
                    "type": "number"
                  },
                  {
                    "type": "null"
                  }
                ]
              },
              "max_depth": {
                "anyOf": [
                  {
                    "type": "number"
                  },
                  {
                    "type": "null"
                  }
                ]
              }
            },
            "required": [
              "script_name",
              "enabled",
              "find_regex",
              "replace_string",
              "source",
              "destination"
            ]
          }
        },
        "tavern_helper": {
          "type": "object",
          "properties": {
            "scripts": {
              "default": [],
              "type": "array",
              "items": {
                "oneOf": [
                  {
                    "$ref": "#/$defs/__schema37"
                  },
                  {
                    "type": "object",
                    "properties": {
                      "type": {
                        "type": "string",
                        "const": "folder"
                      },
                      "enabled": {
                        "type": "boolean"
                      },
                      "name": {
                        "type": "string"
                      },
                      "id": {
                        "default": "59a3dc11-90d2-4b1d-bac5-b951135b7d41",
                        "type": "string"
                      },
                      "icon": {
                        "default": "fa-solid fa-folder",
                        "type": "string"
                      },
                      "color": {
                        "default": "rgba(219, 219, 214, 1)",
                        "type": "string"
                      },
                      "scripts": {
                        "default": [],
                        "type": "array",
                        "items": {
                          "$ref": "#/$defs/__schema37"
                        }
                      }
                    },
                    "required": [
                      "type",
                      "enabled",
                      "name"
                    ]
                  }
                ]
              }
            },
            "variables": {
              "default": {},
              "type": "object",
              "propertyNames": {
                "type": "string"
              },
              "additionalProperties": {}
            }
          }
        }
      },
      "required": [
        "regex_scripts",
        "tavern_helper"
      ],
      "additionalProperties": {}
    },
    "__schema37": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "script"
        },
        "enabled": {
          "type": "boolean"
        },
        "name": {
          "type": "string"
        },
        "id": {
          "default": "f94d5d48-44d9-407f-b14d-44e816f10e38",
          "type": "string"
        },
        "content": {
          "type": "string"
        },
        "info": {
          "type": "string"
        },
        "button": {
          "default": {},
          "type": "object",
          "properties": {
            "enabled": {
              "default": true,
              "type": "boolean"
            },
            "buttons": {
              "default": [],
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "visible": {
                    "type": "boolean"
                  }
                },
                "required": [
                  "name",
                  "visible"
                ]
              }
            }
          }
        },
        "data": {
          "default": {},
          "type": "object",
          "propertyNames": {
            "type": "string"
          },
          "additionalProperties": {}
        }
      },
      "required": [
        "type",
        "enabled",
        "name",
        "content"
      ]
    }
  }
}