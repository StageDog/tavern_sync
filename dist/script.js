/*! For license information please see script.js.LICENSE.txt */
import*as __WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_compare_versions_esm_4fbc8a69__ from'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import*as __WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_socket_io_client_esm_9776f867__ from'https://testingcf.jsdelivr.net/npm/socket.io-client/+esm';var __webpack_modules__={'./src/client/index.ts':(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _client_preset__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @client/preset */ "./src/client/preset.ts");\n/* harmony import */ var _client_worldbook__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @client/worldbook */ "./src/client/worldbook.ts");\n/* harmony import */ var compare_versions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! compare-versions */ "compare-versions");\n\n\n\n$(async () => {\n    const version = await getTavernHelperVersion();\n    if ((0,compare_versions__WEBPACK_IMPORTED_MODULE_2__.compare)(version, \'3.4.0\', \'<\')) {\n        throw new Error(\'酒馆助手版本过低, 不能使用酒馆同步脚本, 请更新至 3.4.0 或更高版本\');\n    }\n    (0,_client_worldbook__WEBPACK_IMPORTED_MODULE_1__.register_worldbook)();\n    (0,_client_preset__WEBPACK_IMPORTED_MODULE_0__.register_preset)();\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L2luZGV4LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBaUQ7QUFDTTtBQUNaO0FBRTNDLENBQUMsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUNYLE1BQU0sT0FBTyxHQUFHLE1BQU0sc0JBQXNCLEVBQUUsQ0FBQztJQUMvQyxJQUFJLHlEQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQ25DLE1BQU0sSUFBSSxLQUFLLENBQUMsd0NBQXdDLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBQ0QscUVBQWtCLEVBQUUsQ0FBQztJQUNyQiwrREFBZSxFQUFFLENBQUM7QUFDcEIsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlLy4vc3JjL2NsaWVudC9pbmRleC50cz8iXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVnaXN0ZXJfcHJlc2V0IH0gZnJvbSAnQGNsaWVudC9wcmVzZXQnO1xuaW1wb3J0IHsgcmVnaXN0ZXJfd29ybGRib29rIH0gZnJvbSAnQGNsaWVudC93b3JsZGJvb2snO1xuaW1wb3J0IHsgY29tcGFyZSB9IGZyb20gJ2NvbXBhcmUtdmVyc2lvbnMnO1xuXG4kKGFzeW5jICgpID0+IHtcbiAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldFRhdmVybkhlbHBlclZlcnNpb24oKTtcbiAgaWYgKGNvbXBhcmUodmVyc2lvbiwgJzMuNC4wJywgJzwnKSkge1xuICAgIHRocm93IG5ldyBFcnJvcign6YWS6aaG5Yqp5omL54mI5pys6L+H5L2OLCDkuI3og73kvb/nlKjphZLppoblkIzmraXohJrmnKwsIOivt+abtOaWsOiHsyAzLjQuMCDmiJbmm7Tpq5jniYjmnKwnKTtcbiAgfVxuICByZWdpc3Rlcl93b3JsZGJvb2soKTtcbiAgcmVnaXN0ZXJfcHJlc2V0KCk7XG59KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/client/index.ts\n\n}')},'./src/client/preset.ts':(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   register_preset: () => (/* binding */ register_preset)\n/* harmony export */ });\n/* harmony import */ var _client_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @client/settings */ "./src/client/settings.ts");\n/* harmony import */ var _client_socket__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @client/socket */ "./src/client/socket.ts");\n\n\nasync function update_preset(name, data) {\n    await createOrReplacePreset(name, data);\n    if (getLoadedPresetName() === name) {\n        console.info(getLoadedPresetName(), name);\n        loadPreset(name);\n    }\n}\nconst update_preset_debounced = _.debounce(update_preset, (0,_client_settings__WEBPACK_IMPORTED_MODULE_0__.get_settings)().delay);\nfunction register_preset() {\n    const socket = (0,_client_socket__WEBPACK_IMPORTED_MODULE_1__.get_socket)();\n    socket.on(\'pull_preset\', (data, callback) => {\n        console.info(`[TavernSync] 收到提取预设 \'${data.name}\' 的请求`);\n        try {\n            const preset = getPreset(getLoadedPresetName() === data.name ? \'in_use\' : data.name);\n            console.info(preset);\n            callback(preset);\n        }\n        catch (err) {\n            const error = err;\n            console.error(`[TavernSync] 提取预设 \'${data.name}\' 失败: ${error}`);\n            callback(error.message);\n        }\n    });\n    socket.on(\'push_preset\', (data, callback) => {\n        console.info(`[TavernSync] 收到推送预设 \'${data.name}\' 的请求`);\n        update_preset_debounced(data.name, data.data);\n        callback();\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L3ByZXNldC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0Q7QUFDSjtBQUU1QyxLQUFLLFVBQVUsYUFBYSxDQUFDLElBQVksRUFBRSxJQUFZO0lBQ3JELE1BQU0scUJBQXFCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3hDLElBQUksbUJBQW1CLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQztRQUNuQyxPQUFPLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDMUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25CLENBQUM7QUFDSCxDQUFDO0FBQ0QsTUFBTSx1QkFBdUIsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLGFBQWEsRUFBRSw4REFBWSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7QUFFekUsU0FBUyxlQUFlO0lBQzdCLE1BQU0sTUFBTSxHQUFHLDBEQUFVLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDLElBQXNCLEVBQUUsUUFBeUMsRUFBRSxFQUFFO1FBQzdGLE9BQU8sQ0FBQyxJQUFJLENBQUMsd0JBQXdCLElBQUksQ0FBQyxJQUFJLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQztZQUNILE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxtQkFBbUIsRUFBRSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3JGLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDckIsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ25CLENBQUM7UUFBQyxPQUFPLEdBQUcsRUFBRSxDQUFDO1lBQ2IsTUFBTSxLQUFLLEdBQUcsR0FBWSxDQUFDO1lBQzNCLE9BQU8sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLElBQUksQ0FBQyxJQUFJLFNBQVMsS0FBSyxFQUFFLENBQUMsQ0FBQztZQUMvRCxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzFCLENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztJQUNILE1BQU0sQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsSUFBb0MsRUFBRSxRQUFvQixFQUFFLEVBQUU7UUFDdEYsT0FBTyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsSUFBSSxDQUFDLElBQUksT0FBTyxDQUFDLENBQUM7UUFDdkQsdUJBQXVCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsUUFBUSxFQUFFLENBQUM7SUFDYixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlLy4vc3JjL2NsaWVudC9wcmVzZXQudHM/Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldF9zZXR0aW5ncyB9IGZyb20gJ0BjbGllbnQvc2V0dGluZ3MnO1xuaW1wb3J0IHsgZ2V0X3NvY2tldCB9IGZyb20gJ0BjbGllbnQvc29ja2V0JztcblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlX3ByZXNldChuYW1lOiBzdHJpbmcsIGRhdGE6IFByZXNldCkge1xuICBhd2FpdCBjcmVhdGVPclJlcGxhY2VQcmVzZXQobmFtZSwgZGF0YSk7XG4gIGlmIChnZXRMb2FkZWRQcmVzZXROYW1lKCkgPT09IG5hbWUpIHtcbiAgICBjb25zb2xlLmluZm8oZ2V0TG9hZGVkUHJlc2V0TmFtZSgpLCBuYW1lKTtcbiAgICBsb2FkUHJlc2V0KG5hbWUpO1xuICB9XG59XG5jb25zdCB1cGRhdGVfcHJlc2V0X2RlYm91bmNlZCA9IF8uZGVib3VuY2UodXBkYXRlX3ByZXNldCwgZ2V0X3NldHRpbmdzKCkuZGVsYXkpO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJfcHJlc2V0KCkge1xuICBjb25zdCBzb2NrZXQgPSBnZXRfc29ja2V0KCk7XG4gIHNvY2tldC5vbigncHVsbF9wcmVzZXQnLCAoZGF0YTogeyBuYW1lOiBzdHJpbmcgfSwgY2FsbGJhY2s6IChkYXRhOiBQcmVzZXQgfCBzdHJpbmcpID0+IHZvaWQpID0+IHtcbiAgICBjb25zb2xlLmluZm8oYFtUYXZlcm5TeW5jXSDmlLbliLDmj5Dlj5bpooTorr4gJyR7ZGF0YS5uYW1lfScg55qE6K+35rGCYCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByZXNldCA9IGdldFByZXNldChnZXRMb2FkZWRQcmVzZXROYW1lKCkgPT09IGRhdGEubmFtZSA/ICdpbl91c2UnIDogZGF0YS5uYW1lKTtcbiAgICAgIGNvbnNvbGUuaW5mbyhwcmVzZXQpO1xuICAgICAgY2FsbGJhY2socHJlc2V0KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnN0IGVycm9yID0gZXJyIGFzIEVycm9yO1xuICAgICAgY29uc29sZS5lcnJvcihgW1RhdmVyblN5bmNdIOaPkOWPlumihOiuviAnJHtkYXRhLm5hbWV9JyDlpLHotKU6ICR7ZXJyb3J9YCk7XG4gICAgICBjYWxsYmFjayhlcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH0pO1xuICBzb2NrZXQub24oJ3B1c2hfcHJlc2V0JywgKGRhdGE6IHsgbmFtZTogc3RyaW5nOyBkYXRhOiBQcmVzZXQgfSwgY2FsbGJhY2s6ICgpID0+IHZvaWQpID0+IHtcbiAgICBjb25zb2xlLmluZm8oYFtUYXZlcm5TeW5jXSDmlLbliLDmjqjpgIHpooTorr4gJyR7ZGF0YS5uYW1lfScg55qE6K+35rGCYCk7XG4gICAgdXBkYXRlX3ByZXNldF9kZWJvdW5jZWQoZGF0YS5uYW1lLCBkYXRhLmRhdGEpO1xuICAgIGNhbGxiYWNrKCk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/client/preset.ts\n\n}')},'./src/client/settings.ts':(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get_settings: () => (/* binding */ get_settings)\n/* harmony export */ });\nconst Settings = z.object({\n    url: z.string().default(\'http://localhost:6620\'),\n    delay: z.number().min(0).default(500),\n});\nconst variable_option = { type: \'script\', script_id: getScriptId() };\nlet settings;\nfunction get_settings() {\n    if (!settings) {\n        settings = Settings.parse(getVariables(variable_option));\n        insertVariables(settings, variable_option);\n    }\n    return settings;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L3NldHRpbmdzLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFDQSxNQUFNLFFBQVEsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQ3hCLEdBQUcsRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0lBQ2hELEtBQUssRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7Q0FDdEMsQ0FBQyxDQUFDO0FBRUgsTUFBTSxlQUFlLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsRUFBVyxDQUFDO0FBRTlFLElBQUksUUFBa0IsQ0FBQztBQUNoQixTQUFTLFlBQVk7SUFDMUIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2QsUUFBUSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7UUFDekQsZUFBZSxDQUFDLFFBQVEsRUFBRSxlQUFlLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBQ0QsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvLi9zcmMvY2xpZW50L3NldHRpbmdzLnRzPyJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIFNldHRpbmdzID0gei5pbmZlcjx0eXBlb2YgU2V0dGluZ3M+O1xuY29uc3QgU2V0dGluZ3MgPSB6Lm9iamVjdCh7XG4gIHVybDogei5zdHJpbmcoKS5kZWZhdWx0KCdodHRwOi8vbG9jYWxob3N0OjY2MjAnKSxcbiAgZGVsYXk6IHoubnVtYmVyKCkubWluKDApLmRlZmF1bHQoNTAwKSxcbn0pO1xuXG5jb25zdCB2YXJpYWJsZV9vcHRpb24gPSB7IHR5cGU6ICdzY3JpcHQnLCBzY3JpcHRfaWQ6IGdldFNjcmlwdElkKCkgfSBhcyBjb25zdDtcblxubGV0IHNldHRpbmdzOiBTZXR0aW5ncztcbmV4cG9ydCBmdW5jdGlvbiBnZXRfc2V0dGluZ3MoKTogU2V0dGluZ3Mge1xuICBpZiAoIXNldHRpbmdzKSB7XG4gICAgc2V0dGluZ3MgPSBTZXR0aW5ncy5wYXJzZShnZXRWYXJpYWJsZXModmFyaWFibGVfb3B0aW9uKSk7XG4gICAgaW5zZXJ0VmFyaWFibGVzKHNldHRpbmdzLCB2YXJpYWJsZV9vcHRpb24pO1xuICB9XG4gIHJldHVybiBzZXR0aW5ncztcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/client/settings.ts\n\n}')},'./src/client/socket.ts':(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get_socket: () => (/* binding */ get_socket)\n/* harmony export */ });\n/* harmony import */ var _client_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @client/settings */ "./src/client/settings.ts");\n/* harmony import */ var socket_io_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! socket.io-client */ "socket.io-client");\n\n\nlet socket = null;\nfunction get_socket() {\n    if (!socket) {\n        const settings = (0,_client_settings__WEBPACK_IMPORTED_MODULE_0__.get_settings)();\n        socket = (0,socket_io_client__WEBPACK_IMPORTED_MODULE_1__.io)(settings.url, {\n            transports: [\'websocket\'],\n        });\n        socket.on(\'connect\', () => {\n            console.info(\'[TavernSync] 成功连接至服务器\');\n        });\n        socket.on(\'connect_error\', (error) => {\n            console.error(`[TavernSync] 连接服务器出错, 尝试重连! ${error.stack}`);\n        });\n        socket.on(\'disconnect\', (reason, details) => {\n            console.info(`[TavernSync] 与服务器断开连接: ${reason}\\n${JSON.stringify(details)}`);\n        });\n    }\n    return socket;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L3NvY2tldC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0Q7QUFFRjtBQUU5QyxJQUFJLE1BQU0sR0FBa0IsSUFBSSxDQUFDO0FBQzFCLFNBQVMsVUFBVTtJQUN4QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDWixNQUFNLFFBQVEsR0FBRyw4REFBWSxFQUFFLENBQUM7UUFDaEMsTUFBTSxHQUFHLG9EQUFFLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRTtZQUN4QixVQUFVLEVBQUUsQ0FBQyxXQUFXLENBQUM7U0FDMUIsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsR0FBRyxFQUFFO1lBQ3hCLE9BQU8sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUNILE1BQU0sQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFLENBQUMsS0FBWSxFQUFFLEVBQUU7WUFDMUMsT0FBTyxDQUFDLEtBQUssQ0FBQywrQkFBK0IsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7UUFDSCxNQUFNLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsRUFBRTtZQUMxQyxPQUFPLENBQUMsSUFBSSxDQUFDLDBCQUEwQixNQUFNLEtBQUssSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDL0UsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0QsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvLi9zcmMvY2xpZW50L3NvY2tldC50cz8iXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0X3NldHRpbmdzIH0gZnJvbSAnQGNsaWVudC9zZXR0aW5ncyc7XG5cbmltcG9ydCB7IGlvLCBTb2NrZXQgfSBmcm9tICdzb2NrZXQuaW8tY2xpZW50JztcblxubGV0IHNvY2tldDogU29ja2V0IHwgbnVsbCA9IG51bGw7XG5leHBvcnQgZnVuY3Rpb24gZ2V0X3NvY2tldCgpOiBTb2NrZXQge1xuICBpZiAoIXNvY2tldCkge1xuICAgIGNvbnN0IHNldHRpbmdzID0gZ2V0X3NldHRpbmdzKCk7XG4gICAgc29ja2V0ID0gaW8oc2V0dGluZ3MudXJsLCB7XG4gICAgICB0cmFuc3BvcnRzOiBbJ3dlYnNvY2tldCddLFxuICAgIH0pO1xuXG4gICAgc29ja2V0Lm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgY29uc29sZS5pbmZvKCdbVGF2ZXJuU3luY10g5oiQ5Yqf6L+e5o6l6Iez5pyN5Yqh5ZmoJyk7XG4gICAgfSk7XG4gICAgc29ja2V0Lm9uKCdjb25uZWN0X2Vycm9yJywgKGVycm9yOiBFcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgW1RhdmVyblN5bmNdIOi/nuaOpeacjeWKoeWZqOWHuumUmSwg5bCd6K+V6YeN6L+eISAke2Vycm9yLnN0YWNrfWApO1xuICAgIH0pO1xuICAgIHNvY2tldC5vbignZGlzY29ubmVjdCcsIChyZWFzb24sIGRldGFpbHMpID0+IHtcbiAgICAgIGNvbnNvbGUuaW5mbyhgW1RhdmVyblN5bmNdIOS4juacjeWKoeWZqOaWreW8gOi/nuaOpTogJHtyZWFzb259XFxuJHtKU09OLnN0cmluZ2lmeShkZXRhaWxzKX1gKTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gc29ja2V0O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/client/socket.ts\n\n}')},'./src/client/worldbook.ts':(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   register_worldbook: () => (/* binding */ register_worldbook)\n/* harmony export */ });\n/* harmony import */ var _client_settings__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @client/settings */ "./src/client/settings.ts");\n/* harmony import */ var _client_socket__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @client/socket */ "./src/client/socket.ts");\n\n\nasync function update_worldbook(name, data) {\n    await createOrReplaceWorldbook(name, data);\n}\nconst update_worldbook_debounced = _.debounce(update_worldbook, (0,_client_settings__WEBPACK_IMPORTED_MODULE_0__.get_settings)().delay);\nfunction register_worldbook() {\n    const socket = (0,_client_socket__WEBPACK_IMPORTED_MODULE_1__.get_socket)();\n    socket.on(\'pull_worldbook\', async (data, callback) => {\n        console.info(`[TavernSync] 收到提取世界书 \'${data.name}\' 的请求`);\n        try {\n            callback(await getWorldbook(data.name));\n        }\n        catch (err) {\n            const error = err;\n            console.error(`[TavernSync] 提取世界书 \'${data.name}\' 失败: ${error}`);\n            callback(error.message);\n        }\n    });\n    socket.on(\'push_worldbook\', (data, callback) => {\n        console.info(`[TavernSync] 收到推送世界书 \'${data.name}\' 的请求`);\n        update_worldbook_debounced(data.name, data.data.entries);\n        callback();\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY2xpZW50L3dvcmxkYm9vay50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBZ0Q7QUFDSjtBQUk1QyxLQUFLLFVBQVUsZ0JBQWdCLENBQUMsSUFBWSxFQUFFLElBQW1DO0lBQy9FLE1BQU0sd0JBQXdCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzdDLENBQUM7QUFDRCxNQUFNLDBCQUEwQixHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsOERBQVksRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRS9FLFNBQVMsa0JBQWtCO0lBQ2hDLE1BQU0sTUFBTSxHQUFHLDBEQUFVLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQUMsRUFBRSxDQUFDLGdCQUFnQixFQUFFLEtBQUssRUFBRSxJQUFzQixFQUFFLFFBQW1ELEVBQUUsRUFBRTtRQUNoSCxPQUFPLENBQUMsSUFBSSxDQUFDLHlCQUF5QixJQUFJLENBQUMsSUFBSSxPQUFPLENBQUMsQ0FBQztRQUN4RCxJQUFJLENBQUM7WUFDSCxRQUFRLENBQUMsTUFBTSxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDMUMsQ0FBQztRQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFDYixNQUFNLEtBQUssR0FBRyxHQUFZLENBQUM7WUFDM0IsT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsSUFBSSxDQUFDLElBQUksU0FBUyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1lBQ2hFLFFBQVEsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDMUIsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0gsTUFBTSxDQUFDLEVBQUUsQ0FDUCxnQkFBZ0IsRUFDaEIsQ0FBQyxJQUF3RSxFQUFFLFFBQW9CLEVBQUUsRUFBRTtRQUNqRyxPQUFPLENBQUMsSUFBSSxDQUFDLHlCQUF5QixJQUFJLENBQUMsSUFBSSxPQUFPLENBQUMsQ0FBQztRQUN4RCwwQkFBMEIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDekQsUUFBUSxFQUFFLENBQUM7SUFDYixDQUFDLENBQ0YsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90YXZlcm5faGVscGVyX3RlbXBsYXRlLy4vc3JjL2NsaWVudC93b3JsZGJvb2sudHM/Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldF9zZXR0aW5ncyB9IGZyb20gJ0BjbGllbnQvc2V0dGluZ3MnO1xuaW1wb3J0IHsgZ2V0X3NvY2tldCB9IGZyb20gJ0BjbGllbnQvc29ja2V0JztcblxuaW1wb3J0IHsgUGFydGlhbERlZXAgfSBmcm9tICd0eXBlLWZlc3QnO1xuXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVfd29ybGRib29rKG5hbWU6IHN0cmluZywgZGF0YTogUGFydGlhbERlZXA8V29ybGRib29rRW50cnk+W10pIHtcbiAgYXdhaXQgY3JlYXRlT3JSZXBsYWNlV29ybGRib29rKG5hbWUsIGRhdGEpO1xufVxuY29uc3QgdXBkYXRlX3dvcmxkYm9va19kZWJvdW5jZWQgPSBfLmRlYm91bmNlKHVwZGF0ZV93b3JsZGJvb2ssIGdldF9zZXR0aW5ncygpLmRlbGF5KTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyX3dvcmxkYm9vaygpIHtcbiAgY29uc3Qgc29ja2V0ID0gZ2V0X3NvY2tldCgpO1xuICBzb2NrZXQub24oJ3B1bGxfd29ybGRib29rJywgYXN5bmMgKGRhdGE6IHsgbmFtZTogc3RyaW5nIH0sIGNhbGxiYWNrOiAoZGF0YTogV29ybGRib29rRW50cnlbXSB8IHN0cmluZykgPT4gdm9pZCkgPT4ge1xuICAgIGNvbnNvbGUuaW5mbyhgW1RhdmVyblN5bmNdIOaUtuWIsOaPkOWPluS4lueVjOS5piAnJHtkYXRhLm5hbWV9JyDnmoTor7fmsYJgKTtcbiAgICB0cnkge1xuICAgICAgY2FsbGJhY2soYXdhaXQgZ2V0V29ybGRib29rKGRhdGEubmFtZSkpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc3QgZXJyb3IgPSBlcnIgYXMgRXJyb3I7XG4gICAgICBjb25zb2xlLmVycm9yKGBbVGF2ZXJuU3luY10g5o+Q5Y+W5LiW55WM5LmmICcke2RhdGEubmFtZX0nIOWksei0pTogJHtlcnJvcn1gKTtcbiAgICAgIGNhbGxiYWNrKGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgfSk7XG4gIHNvY2tldC5vbihcbiAgICAncHVzaF93b3JsZGJvb2snLFxuICAgIChkYXRhOiB7IG5hbWU6IHN0cmluZzsgZGF0YTogeyBlbnRyaWVzOiBQYXJ0aWFsRGVlcDxXb3JsZGJvb2tFbnRyeT5bXSB9IH0sIGNhbGxiYWNrOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgICBjb25zb2xlLmluZm8oYFtUYXZlcm5TeW5jXSDmlLbliLDmjqjpgIHkuJbnlYzkuaYgJyR7ZGF0YS5uYW1lfScg55qE6K+35rGCYCk7XG4gICAgICB1cGRhdGVfd29ybGRib29rX2RlYm91bmNlZChkYXRhLm5hbWUsIGRhdGEuZGF0YS5lbnRyaWVzKTtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfSxcbiAgKTtcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/client/worldbook.ts\n\n}')},'compare-versions':Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_compare_versions_esm_4fbc8a69__},'socket.io-client':Q=>{Q.exports=__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_socket_io_client_esm_9776f867__}},__webpack_module_cache__={};function __webpack_require__(Q){var U=__webpack_module_cache__[Q];if(void 0!==U)return U.exports;var e=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(Q,U)=>{for(var e in U)__webpack_require__.o(U,e)&&!__webpack_require__.o(Q,e)&&Object.defineProperty(Q,e,{enumerable:!0,get:U[e]})},__webpack_require__.o=(Q,U)=>Object.prototype.hasOwnProperty.call(Q,U),__webpack_require__.r=Q=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(Q,'__esModule',{value:!0})};var __webpack_exports__=__webpack_require__('./src/client/index.ts');